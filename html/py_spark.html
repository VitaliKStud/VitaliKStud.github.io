<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>PySpark &mdash; DARIMA 23.08.2023 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="_static/my_theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=7b807efb"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="R Code" href="r.html" />
    <link rel="prev" title="Darima" href="darima.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: black" >

          
          
          <a href="index.html" class="icon icon-home">
            DARIMA
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="darima.html">Darima</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">PySpark</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#spark-py">spark.py</a></li>
<li class="toctree-l2"><a class="reference internal" href="#py_spark.spark.start_spark"><code class="docutils literal notranslate"><span class="pre">start_spark()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#logging">logging</a></li>
<li class="toctree-l2"><a class="reference internal" href="#py_spark.logging.Log4j"><code class="docutils literal notranslate"><span class="pre">Log4j</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#py_spark.logging.Log4j.__init__"><code class="docutils literal notranslate"><span class="pre">Log4j.__init__()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#py_spark.logging.Log4j.error"><code class="docutils literal notranslate"><span class="pre">Log4j.error()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#py_spark.logging.Log4j.info"><code class="docutils literal notranslate"><span class="pre">Log4j.info()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#py_spark.logging.Log4j.warn"><code class="docutils literal notranslate"><span class="pre">Log4j.warn()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="r.html">R Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="py_handlers.html">Python Handlers</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: black" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">DARIMA</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">PySpark</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/py_spark.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-py_spark.spark">
<span id="pyspark"></span><h1>PySpark<a class="headerlink" href="#module-py_spark.spark" title="Link to this heading"></a></h1>
<section id="spark-py">
<h2>spark.py<a class="headerlink" href="#spark-py" title="Link to this heading"></a></h2>
<p>Module containing helper function for use with Apache Spark</p>
</section>
<dl class="py function">
<dt class="sig sig-object py" id="py_spark.spark.start_spark">
<span class="sig-prename descclassname"><span class="pre">py_spark.spark.</span></span><span class="sig-name descname"><span class="pre">start_spark</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'my_spark_app'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">master</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'local[*]'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jar_packages</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">files</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spark_config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/py_spark/spark.html#start_spark"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#py_spark.spark.start_spark" title="Link to this definition"></a></dt>
<dd><p>Start Spark session, get Spark logger and load config files.</p>
<p>Start a Spark session on the worker node and register the Spark
application with the cluster. Note, that only the app_name argument
will apply when this is called from a script sent to spark-submit.
All other arguments exist solely for testing the script from within
an interactive Python console.</p>
<p>This function also looks for a file ending in ‘darima_config.json’ that
can be sent with the Spark job. If it is found, it is opened,
the contents parsed (assuming it contains valid JSON for the model
configuration) into a dict of model configuration parameters,
which are returned as the last element in the tuple returned by
this function. If the file cannot be found then the return tuple
only contains the Spark session and Spark logger objects and None
for config.</p>
<p>The function checks the enclosing environment to see if it is being
run from inside an interactive console session or from an
environment which has a <cite>DEBUG</cite> environment variable set (e.g.
setting <cite>DEBUG=1</cite> as an environment variable as part of a debug
configuration within an IDE such as Visual Studio Code or PyCharm.
In this scenario, the function uses all available function arguments
to start a PySpark driver from the local PySpark package as opposed
to using the spark-submit and Spark cluster defaults. This will also
use local module imports, as opposed to those in the zip archive
sent to spark via the –py-files flag in spark-submit.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>app_name</strong> – Name of Spark app.</p></li>
<li><p><strong>master</strong> – Cluster connection details (defaults to local[*]).</p></li>
<li><p><strong>jar_packages</strong> – List of Spark JAR package names.</p></li>
<li><p><strong>files</strong> – List of files to send to Spark cluster (master and
workers).</p></li>
<li><p><strong>spark_config</strong> – Dictionary of config key-value pairs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple of references to the Spark session, logger and
config dict (only if available).</p>
</dd>
</dl>
</dd></dl>

<section id="logging">
<span id="module-py_spark.logging"></span><h2>logging<a class="headerlink" href="#logging" title="Link to this heading"></a></h2>
<p>This module contains a class that wraps the log4j object instantiated
by the active SparkContext, enabling Log4j logging for PySpark using.</p>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="py_spark.logging.Log4j">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">py_spark.logging.</span></span><span class="sig-name descname"><span class="pre">Log4j</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spark</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/py_spark/logging.html#Log4j"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#py_spark.logging.Log4j" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Wrapper class for Log4j JVM object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>spark</strong> – SparkSession object.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="py_spark.logging.Log4j.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spark</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/py_spark/logging.html#Log4j.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#py_spark.logging.Log4j.__init__" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="py_spark.logging.Log4j.error">
<span class="sig-name descname"><span class="pre">error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/py_spark/logging.html#Log4j.error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#py_spark.logging.Log4j.error" title="Link to this definition"></a></dt>
<dd><p>Log an error.</p>
<dl class="field-list simple">
<dt class="field-odd">Param<span class="colon">:</span></dt>
<dd class="field-odd"><p>Error message to write to log</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="py_spark.logging.Log4j.info">
<span class="sig-name descname"><span class="pre">info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/py_spark/logging.html#Log4j.info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#py_spark.logging.Log4j.info" title="Link to this definition"></a></dt>
<dd><p>Log information.</p>
<dl class="field-list simple">
<dt class="field-odd">Param<span class="colon">:</span></dt>
<dd class="field-odd"><p>Information message to write to log</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="py_spark.logging.Log4j.warn">
<span class="sig-name descname"><span class="pre">warn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/py_spark/logging.html#Log4j.warn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#py_spark.logging.Log4j.warn" title="Link to this definition"></a></dt>
<dd><p>Log a warning.</p>
<dl class="field-list simple">
<dt class="field-odd">Param<span class="colon">:</span></dt>
<dd class="field-odd"><p>Warning message to write to log</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="darima.html" class="btn btn-neutral float-left" title="Darima" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="r.html" class="btn btn-neutral float-right" title="R Code" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright -.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>